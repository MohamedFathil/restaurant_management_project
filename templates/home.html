{% extends 'base.html' %}

{% block title %}Home - {{restaurant_name|default:"Restaurant Management"}} {% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home.css' %}">
{% endblock %}

{% block content %}
<section class="home-section">
    <!-- logo -->
    {% if restaurant and restaurant.logo %}
        <img src="{{restaurant.logo.url}}" alt="{{restaurant.name|default:'Restaurant Logo'}}" class="restaurant-logo">
    {% else %}
        <img src="{% static 'images/logo.png' %}" alt="Default Logo" class="restaurant-logo">
    {% endif %}

    <h2>Welcome to {{ restaurant_name }}</h2>
    <!-- Tagline -->
    <p class="tagline">A journey back in time with every bite - familiar aromas, comforting flavors and memories that never fade.</p>

    <!-- Order Now button -->
    <div class="order-now-container">
        <a href="{% url 'order_page' %}" class="order-now-btn">Order Now</a>
    </div>
    
    <!-- Current Date and Time -->
    <div class="date-time">
        <p>Date : {% now "l, d F Y" %}</p>
        <p>Time : <span id="current-time"></span></p>
    </div>

    <!-- Search Bar -->
    <form method="get" action="" class="search-form">
        <input type="text" name="q" placeholder="Search menu items..." value="{{request.GET.q}}" class="search-input">
        <button type="submit" class="search-button">Search</button>
    </form>

    <!-- Navigation link -->
    <a href="{% url 'about' %}">Learn more about us</a>
    <a href="{% url 'contact' %}">Contact here</a>

    <!-- Menu items -->
    <section class="menu-section">
        <h3>Our Menu</h3>
        {% if query %}
            <p>Showing result for : <strong>{{query}}</strong></p>
            {% if not menu_items %}
                <p>No menu item found for the "{{query}}"</p>
            {% endif %}
        {% endif %}

        {% if menu_items %}
            <ul class="menu-lists">
                {% for item in menu_items %}
                    <li class="menu-item">
                        <strong>{{item.name}}</strong> - {{item.price}}<br>
                        <em>{{item.description}}</em>
                        <a href="{% url 'add_to_cart' item.id %}" class="btn">Add to cart</a>
                    </li>
                {% endfor %}
            </ul>
        {% elif not query %}
            <p>No menu items available</p>
        {% endif %}
    </section>

    <!-- Todays Special -->
    <section class="special-section">
        <h3>Today's Special</h3>
        {% if specials %}
            <ul class="special-list">
                {% for item in specials %}
                    <li class="special-item">
                        <strong>{{item.name}}</strong> - {{item.price}} <br>
                        <em>{{item.description}}</em>
                        <a href="{% url 'add_to_cart' item.id %}" class="btn">Add to cart</a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No specials available today.</p>
        {% endif %}
    </section>

    <!-- Location Address setup -->
    <section class="location-address">
        <h3>Visit us</h3>
        {% if restaurant_address %}
            <p><strong>{{restaurant_address.name}}</strong></p>
            <p>{{restaurant_address.address}}</p>
            <p><strong>Phone : </strong>
                {% if restaurant_address.phone %}
                    {{restaurant_address.phone}}
                {% elif restaurant %}
                    {{restaurant.phone}}
                {% else %}
                    {{Not available}}
                {% endif %}
            </p>
        {% else %}
            <p>Address not available</p>
        {% endif %}
        
        {% if map_url %}
            <iframe src="{{map_url}}" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy">
            </iframe>
        {% endif %}
    </section>
    <section class="opening-hours">
        <h3>Opening Hours</h3>
        {% if opening_hours %}
            <ul>
                {% for day, hours in opening_hours.items %}
                    <li><strong>{{day}}: </strong>{{hours}}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Opening Hours not available</p>
        {% endif %}
    </section>
    
    <!-- Meet the Chef button -->
    <section class="chef-section">
        <h3>Want to meet our Chef?</h3>
        <a href="{% url 'about_chef' %}" class="btn-about-chef">Meet the Chef</a>
    </section>

    <!-- News Letter  -->
    <section class="newsletter-section">
        <h3>Subscribe to our Newsletter</h3>
        <p>Get the latest update and offers directly in your inbox.</p>
        <form method="post" action="{% url 'newsletter_signup' %}">
            {% csrf_token %}
            {{ newsletter_form.email}}
            <button type="submit">Subscribe</button>
        </form>
        {% if messages %}
            <div class="messages">
                {% for message in messages %}
                    <p class="alert {{message.tags}}">{{message}}</p>
                {% endfor %}
            </div>
        {% endif %}
    </section>
</section>
<script>
    function updateTime(){
        const now = new Date();
        const option = {hour:'2-digit', minute:'2-digit', second:'2-digit', hour12: true};
        document.getElementById('current-time').textContent = now.toLocaleTimeString('en-US', option);
    }
    setInterval(updateTime, 1000);
    updateTime();
</script>
{% endblock %}
